<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>İkinci Dereceden Denklem Oyunu</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f8fa;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }
        .container {
            width: 90%;
            max-width: 700px;
            background-color: #ffffff;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 20px;
        }
        .game-container {
            margin-top: 20px;
        }
        .equation {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 20px;
            padding: 15px;
            background-color: #ecf0f1;
            border-radius: 8px;
            text-align: center;
        }
        .stage {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        .stage-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #3498db;
        }
        .inputs {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        input {
            width: 80px;
            height: 40px;
            text-align: center;
            font-size: 18px;
            border: 2px solid #3498db;
            border-radius: 5px;
            padding: 5px;
        }
        button {
            display: block;
            width: 100%;
            padding: 12px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 15px;
        }
        button:hover {
            background-color: #2980b9;
        }
        .message {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            font-weight: bold;
            min-height: 20px;
        }
        .correct {
            color: #27ae60;
            background-color: #e8f8f2;
        }
        .incorrect {
            color: #e74c3c;
            background-color: #faeceb;
        }
        .score {
            text-align: center;
            font-size: 22px;
            margin: 20px 0;
            font-weight: bold;
            color: #2c3e50;
        }
        .game-over {
            text-align: center;
            font-size: 24px;
            margin-top: 30px;
            color: #e74c3c;
            font-weight: bold;
        }
        .next-btn {
            margin-top: 15px;
            background-color: #2ecc71;
        }
        .next-btn:hover {
            background-color: #27ae60;
        }
        .new-game-btn {
            margin-top: 20px;
            background-color: #e67e22;
        }
        .new-game-btn:hover {
            background-color: #d35400;
        }
        .graph {
            width: 100%;
            height: 250px;
            margin: 20px 0;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .question {
            margin: 15px 0;
            font-size: 16px;
        }
        .choice {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 15px 0;
        }
        .choice-btn {
            width: auto;
            padding: 10px 20px;
        }
        .hidden {
            display: none;
        }
        .coefficient {
            font-weight: bold;
            color: #2980b9;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>İkinci Dereceden Denklem Oyunu</h1>
        
        <div class="score">Puan: <span id="scoreValue">0</span></div>
        
        <!-- Oyun Containeri -->
        <div class="game-container" id="gameContainer">
            <div class="equation" id="equation">
                İkinci dereceden denklem yükleniyor...
            </div>
            
            <!-- Aşama 1: Tepe Noktası -->
            <div class="stage" id="stage1">
                <div class="stage-title">Aşama 1: Tepe Noktasını Bulun</div>
                <div class="question">Yukarıdaki ikinci dereceden denklemin tepe noktasının koordinatlarını bulun:</div>
                <div class="inputs">
                    <div>
                        <input type="number" id="vertexX" placeholder="x" step="0.1">
                        <div>Tepe X</div>
                    </div>
                    <div>
                        <input type="number" id="vertexY" placeholder="y" step="0.1">
                        <div>Tepe Y</div>
                    </div>
                </div>
                <button id="checkVertexBtn">Kontrol Et</button>
                <div class="message" id="vertexMessage"></div>
            </div>
            
            <!-- Aşama 2: Noktanın Denklemi Sağlaması -->
            <div class="stage hidden" id="stage2">
                <div class="stage-title">Aşama 2: Denklemi Kontrol Edin</div>
                <div class="question" id="pointQuestion">
                    Bu nokta denklemi sağlıyor mu?
                </div>
                <div class="choice">
                    <button class="choice-btn" id="yesBtn">Evet, Sağlıyor</button>
                    <button class="choice-btn" id="noBtn">Hayır, Sağlamıyor</button>
                </div>
                <div class="message" id="pointMessage"></div>
            </div>
            
            <!-- Aşama 3: Parabol Yönü -->
            <div class="stage hidden" id="stage3">
                <div class="stage-title">Aşama 3: Parabolün Yönünü Belirleyin</div>
                <div class="question">Bu ikinci dereceden fonksiyonun kolları hangi yöne bakıyor?</div>
                <div class="choice">
                    <button class="choice-btn" id="upBtn">Yukarı</button>
                    <button class="choice-btn" id="downBtn">Aşağı</button>
                </div>
                <div class="message" id="directionMessage"></div>
            </div>
            
            <div class="graph" id="graph">
                <!-- Canvas için yer -->
            </div>
        </div>
        
        <div class="game-over hidden" id="gameOver">Oyun Bitti!</div>
        
        <button class="new-game-btn hidden" id="newGameBtn">Yeni Oyun</button>
    </div>
    
    <script>
        // Oyun değişkenleri
        let score = 0;
        let currentEquation = {};
        
        // HTML elementleri
        const equationElement = document.getElementById('equation');
        const vertexXInput = document.getElementById('vertexX');
        const vertexYInput = document.getElementById('vertexY');
        const checkVertexBtn = document.getElementById('checkVertexBtn');
        const vertexMessageElement = document.getElementById('vertexMessage');
        const scoreElement = document.getElementById('scoreValue');
        const stage1Element = document.getElementById('stage1');
        const stage2Element = document.getElementById('stage2');
        const stage3Element = document.getElementById('stage3');
        const pointQuestionElement = document.getElementById('pointQuestion');
        const yesBtnElement = document.getElementById('yesBtn');
        const noBtnElement = document.getElementById('noBtn');
        const pointMessageElement = document.getElementById('pointMessage');
        const upBtnElement = document.getElementById('upBtn');
        const downBtnElement = document.getElementById('downBtn');
        const directionMessageElement = document.getElementById('directionMessage');
        const gameOverElement = document.getElementById('gameOver');
        const newGameBtnElement = document.getElementById('newGameBtn');
        const graphElement = document.getElementById('graph');
        
        // İkinci dereceden denklem oluştur (ax² + bx + c formatında)
        function generateQuadraticEquation() {
            // a değeri sıfırdan farklı olmalı (0 olursa ikinci dereceden denklem olmaz)
            let a = 0;
            while (a === 0) {
                a = Math.floor(Math.random() * 7) - 3; // -3 ile 3 arasında, 0 hariç
            }
            
            const b = Math.floor(Math.random() * 11) - 5; // -5 ile 5 arasında
            const c = Math.floor(Math.random() * 11) - 5; // -5 ile 5 arasında
            
            // Tepe noktası hesaplama: x = -b/(2a), y = f(x) = c - b²/(4a)
            const vertexX = -b / (2 * a);
            const vertexY = c - (b * b) / (4 * a);
            
            // Kontrol edilecek nokta
            let testX, testY;
            
            // %50 ihtimalle denklemi sağlayan bir nokta oluştur
            const satisfiesEquation = Math.random() > 0.5;
            
            if (satisfiesEquation) {
                // Denklemi sağlayan rastgele bir x değeri seç
                testX = Math.floor(Math.random() * 11) - 5; // -5 ile 5 arasında
                // Denklemi bu noktada hesapla
                testY = a * testX * testX + b * testX + c;
            } else {
                // Denklemi sağlamayan bir nokta oluştur
                testX = Math.floor(Math.random() * 11) - 5; // -5 ile 5 arasında
                testY = a * testX * testX + b * testX + c + (Math.random() > 0.5 ? 1 : -1) * (Math.floor(Math.random() * 5) + 1);
            }
            
            // Denklem bilgilerini döndür
            return {
                a: a,
                b: b,
                c: c,
                vertexX: Number(vertexX.toFixed(2)),
                vertexY: Number(vertexY.toFixed(2)),
                testX: testX,
                testY: Number(testY.toFixed(2)),
                satisfiesEquation: satisfiesEquation,
                direction: a > 0 ? 'up' : 'down' // a > 0 ise kollar yukarı, a < 0 ise kollar aşağı
            };
        }
        
        // Denklemi göster
        function displayEquation(equation) {
            let equationText = `f(x) = `;
            
            // ax² terimi
            if (equation.a === 1) {
                equationText += `x²`;
            } else if (equation.a === -1) {
                equationText += `-x²`;
            } else {
                equationText += `<span class="coefficient">${equation.a}</span>x²`;
            }
            
            // bx terimi
            if (equation.b > 0) {
                equationText += ` + <span class="coefficient">${equation.b}</span>x`;
            } else if (equation.b < 0) {
                equationText += ` - <span class="coefficient">${Math.abs(equation.b)}</span>x`;
            }
            
            // c terimi
            if (equation.c > 0) {
                equationText += ` + <span class="coefficient">${equation.c}</span>`;
            } else if (equation.c < 0) {
                equationText += ` - <span class="coefficient">${Math.abs(equation.c)}</span>`;
            }
            
            equationElement.innerHTML = equationText;
            
            // Test noktası sorusunu güncelle
            pointQuestionElement.innerHTML = `Nokta (${equation.testX}, ${equation.testY}) bu denklemi sağlıyor mu?`;
        }
        
        // Tepe noktası kontrolü
        function checkVertex() {
            const userX = parseFloat(vertexXInput.value);
            const userY = parseFloat(vertexYInput.value);
            
            if (isNaN(userX) || isNaN(userY)) {
                vertexMessageElement.textContent = 'Lütfen her iki koordinatı da girin!';
                vertexMessageElement.className = 'message incorrect';
                return;
            }
            
            // Yaklaşık doğruluk kontrolü (0.1 hassasiyetle)
            const xCorrect = Math.abs(userX - currentEquation.vertexX) < 0.11;
            const yCorrect = Math.abs(userY - currentEquation.vertexY) < 0.11;
            
            if (xCorrect && yCorrect) {
                vertexMessageElement.innerHTML = `Doğru! Tepe noktası (${currentEquation.vertexX}, ${currentEquation.vertexY})`;
                vertexMessageElement.className = 'message correct';
                score += 10;
                scoreElement.textContent = score;
                
                // Aşama 2'ye geç
                setTimeout(() => {
                    stage1Element.classList.add('hidden');
                    stage2Element.classList.remove('hidden');
                }, 1500);
            } else {
                vertexMessageElement.innerHTML = `Yanlış! Doğru cevap: (${currentEquation.vertexX}, ${currentEquation.vertexY})`;
                vertexMessageElement.className = 'message incorrect';
                
                // Oyun sona erer
                endGame(`Tepe noktasını yanlış buldunuz! Doğru cevap: (${currentEquation.vertexX}, ${currentEquation.vertexY}). Oyun bitti.`);
            }
        }
        
        // Nokta kontrolü
        function checkPoint(userAnswer) {
            const correctAnswer = currentEquation.satisfiesEquation;
            
            if (userAnswer === correctAnswer) {
                pointMessageElement.textContent = correctAnswer ? 
                    'Doğru! Bu nokta denklemi sağlıyor.' : 
                    'Doğru! Bu nokta denklemi sağlamıyor.';
                pointMessageElement.className = 'message correct';
                score += 10;
                scoreElement.textContent = score;
                
                // Aşama 3'e geç
                setTimeout(() => {
                    stage2Element.classList.add('hidden');
                    stage3Element.classList.remove('hidden');
                }, 1500);
            } else {
                pointMessageElement.textContent = correctAnswer ? 
                    'Yanlış! Bu nokta denklemi sağlıyor.' : 
                    'Yanlış! Bu nokta denklemi sağlamıyor.';
                pointMessageElement.className = 'message incorrect';
                
                // Puan düş
                score -= 20;
                scoreElement.textContent = score;
            }
        }
        
        // Yön kontrolü
        function checkDirection(userDirection) {
            const correctDirection = currentEquation.direction;
            
            if (userDirection === correctDirection) {
                directionMessageElement.textContent = correctDirection === 'up' ? 
                    'Doğru! Parabolün kolları yukarı bakıyor.' : 
                    'Doğru! Parabolün kolları aşağı bakıyor.';
                directionMessageElement.className = 'message correct';
                score += 10;
                scoreElement.textContent = score;
                
                // Oyunu başarıyla bitir
                setTimeout(() => {
                    endGame(`Tebrikler! Tüm aşamaları başarıyla tamamladınız. Toplam puanınız: ${score}`);
                }, 1500);
            } else {
                directionMessageElement.textContent = correctDirection === 'up' ? 
                    'Yanlış! Parabolün kolları yukarı bakıyor.' : 
                    'Yanlış! Parabolün kolları aşağı bakıyor.';
                directionMessageElement.className = 'message incorrect';
                
                // Puan düş ve oyunu bitir
                score -= 10;
                scoreElement.textContent = score;
                
                setTimeout(() => {
                    endGame(`Parabolün yönünü yanlış belirlediniz! Oyun bitti. Toplam puanınız: ${score}`);
                }, 1500);
            }
        }
        
        // Oyunu bitir
        function endGame(message) {
            stage1Element.classList.add('hidden');
            stage2Element.classList.add('hidden');
            stage3Element.classList.add('hidden');
            
            gameOverElement.textContent = message;
            gameOverElement.classList.remove('hidden');
            newGameBtnElement.classList.remove('hidden');
        }
        
        // Yeni oyun başlat
        function startNewGame() {
            score = 0;
            scoreElement.textContent = score;
            
            currentEquation = generateQuadraticEquation();
            displayEquation(currentEquation);
            
            // Girişleri temizle
            vertexXInput.value = '';
            vertexYInput.value = '';
            vertexMessageElement.textContent = '';
            pointMessageElement.textContent = '';
            directionMessageElement.textContent = '';
            
            // Aşamaları ayarla
            stage1Element.classList.remove('hidden');
            stage2Element.classList.add('hidden');
            stage3Element.classList.add('hidden');
            gameOverElement.classList.add('hidden');
            newGameBtnElement.classList.add('hidden');
            
            // Grafiği çiz
            drawGraph();
        }
        
        // Grafiği çiz
        function drawGraph() {
            // Canvas oluştur
            graphElement.innerHTML = '';
            const canvas = document.createElement('canvas');
            canvas.width = graphElement.clientWidth;
            canvas.height = graphElement.clientHeight;
            graphElement.appendChild(canvas);
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            // Koordinat sistemi çiz
            ctx.clearRect(0, 0, width, height);
            ctx.strokeStyle = '#ccc';
            ctx.lineWidth = 1;
            
            // x ekseni
            ctx.beginPath();
            ctx.moveTo(0, height/2);
            ctx.lineTo(width, height/2);
            ctx.stroke();
            
            // y ekseni
            ctx.beginPath();
            ctx.moveTo(width/2, 0);
            ctx.lineTo(width/2, height);
            ctx.stroke();
            
            // Parabolü çiz
            ctx.strokeStyle = '#3498db';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            const a = currentEquation.a;
            const b = currentEquation.b;
            const c = currentEquation.c;
            
            // Ölçekleme faktörleri
            const scaleX = 20; // x-ekseni ölçeği
            const scaleY = 20; // y-ekseni ölçeği
            
            // Grafiğin başlangıç ve bitiş değerleri
            const startX = -10;
            const endX = 10;
            const step = 0.1;
            
            let isFirstPoint = true;
            for (let x = startX; x <= endX; x += step) {
                const y = a * x * x + b * x + c;
                
                // Ekran koordinatlarına dönüştür
                const screenX = (x * scaleX) + width/2;
                const screenY = height/2 - (y * scaleY);
                
                if (isFirstPoint) {
                    ctx.moveTo(screenX, screenY);
                    isFirstPoint = false;
                } else {
                    ctx.lineTo(screenX, screenY);
                }
            }
            ctx.stroke();
            
            // Tepe noktasını işaretle
            ctx.fillStyle = '#e74c3c';
            const vertexScreenX = (currentEquation.vertexX * scaleX) + width/2;
            const vertexScreenY = height/2 - (currentEquation.vertexY * scaleY);
            ctx.beginPath();
            ctx.arc(vertexScreenX, vertexScreenY, 5, 0, Math.PI * 2);
            ctx.fill();
            
            // Test noktasını işaretle
            ctx.fillStyle = '#2ecc71';
            const testScreenX = (currentEquation.testX * scaleX) + width/2;
            const testScreenY = height/2 - (currentEquation.testY * scaleY);
            ctx.beginPath();
            ctx.arc(testScreenX, testScreenY, 5, 0, Math.PI * 2);
            ctx.fill();
        }
        
        // Olay dinleyicileri
        checkVertexBtn.addEventListener('click', checkVertex);
        yesBtnElement.addEventListener('click', () => checkPoint(true));
        noBtnElement.addEventListener('click', () => checkPoint(false));
        upBtnElement.addEventListener('click', () => checkDirection('up'));
        downBtnElement.addEventListener('click', () => checkDirection('down'));
        newGameBtnElement.addEventListener('click', startNewGame);
        
        // Enter tuşu olayları
        vertexXInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                vertexYInput.focus();
            }
        });
        
        vertexYInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                checkVertex();
            }
        });
        
        // Pencere boyutu değiştiğinde grafiği yeniden çiz
        window.addEventListener('resize', drawGraph);
        
        // Oyunu başlat
        startNewGame();
    </script>
</body>
</html>
